---
date: 2025-07-22
aliases:
  - 黑马Redis
tags:
  - 初识Redis
  - Redis数据结构
  - 通用数据类型
  - String类型
  - Hash类型
  - SortedSet类型
---
## 初识Redis
---
### 1、NoSQL
	定义：非关系型数据库，远程词典服务器，数据以键值对进行存储
	与SQL之间的关系：

| SQL                           | NOSQL                                      |
| ----------------------------- | ------------------------------------------ |
| 结构化：结构不适合修改                   | 非结构化：键值对、文档（MangoDB）、列（HBase）、Graph（Neo4j） |
| 关联的：表与表之间                     | 无关联：数据库不会维护关联性                             |
| SQL语法                         | 非SQL语法，且语法不统一                              |
| 满足ACID                        | BASE                                       |
| 磁盘                            | 内存                                         |
| 垂直扩展                          | 水平扩展                                       |
| 数据结构固定、相关业务对==数据安全性、一致性要求较高== | 数据结构不稳定、对一致性、安全性要求不高、==对性能有要求==            |
	特征
		键值型，支持不同的数据类型，功能丰富
		单线程，每个命令具备原子性，6.0新版处理网络请求具备多线程
		低延迟、速度快，基于内存、IO复用、良好的编码
		支持数据持久化，定期将数据持久化到磁盘，避免断电、关机等情况导致数据丢失
		支持主从集群（从节点备份主节点的数据，提高安全性）、分片集群

### Redis的启动
---
#### 1、下载安装
	在Linux笔记第八天中有

#### 2、启动Redis
```shell
systemctl start redis

redis-cli
```
	语法：redis-cli [options] [commonds]
	常见的options
			-h 127.0.0.1：指定redis的IP地址
			-p 6379：指定redis的端口号
			-a 123321:指定redis的密码
	commonds：Redis的操作命令
		例如，ping：与redis服务端做心跳测试，服务器正常会返回pong
		不指定会直接进入redis-cli的交互控制台

#### 4、设置用户和密码
	先进去，然后使用如下命令
```shell
AUTH 用户名 密码
```



## Redis数据结构
---
#### 1、数据类型
	String：HelloWorld
	Hash：{name:"Jack",age:21}
	List:[A->B->C->C]
	Set:{A,B,C}
	SortedSet:{A:1,B:2,C:3}
	GEO:{A:(120.3,30.5)}  （经纬度）
	BitMap:0110111    （按位存储）
	HyerLog:011011    （按位存储）

#### 2、通用命令
	特点：对于任何数据类型都通用的
	常见命令
		keys：查看符合模版的所有key，生产时不建议使用，会阻塞整个Redis进程
		del：删除一个指定的key，返回值代表删除的个数
		exists：判断一个key是否存在
		expire：设置有效期，到期key会自动被删除
		TTL：查看一个key的有效期，返回值为-1，代表永久有效
#### 3、String类型
	特性：会将数值分为三种类型，字符串、整型（自增自减）、浮点型（自增自减）
	最值：512m

	常见命令
		set：添加一个String类型
		get：获取
		mset：批量添加
		incr：让整型的key增1
		incrby：让一个整型的key自增，并指定步长
			语法：incrby key 步长
		incrbyfloat：让一个浮点类型的数字自增并指定步长
			语法：incrbyfloat key（整形也可） 步长
		setnx：添加一个String类型，key若存在，则不添加
		setex：添加一个String类型，并指定有效期
			语法：setex key 时间（s） value
			注：如果覆盖了原来的变量，即使原来没有期限，也会有期限

#### 4、Key的层级格式
	概念：Redis允许有多个单词形成层级结构，多个单词用":"避免重名冲突问题
	格式：例如
		项目名：业务名：类型：id JSON串
	注意：此时，如果key层名字由部分和以前的重名，则会叠加，不会覆盖

#### 5、Hash类型
	概念：也叫散列，其value是一个无序字典
	优势：不需要像String类型，当存储java对象的时候只能将数据转化为JSON串后存储，不好进行单个修
	      改，而Hash则不需要这样
	常见命令
		hset：添加值
			语法：hset key field（内部的键） value
		hget:查找值
			语法：hget key field
			注：不能只通过key获取
		hmset、hmget：批量存和取
		hgetall：获取一个key中的所有值（不会像是field）
		hkeys：获取一个key中的所有field
		hincrby：给对应的整型值设置自增
			语法：hincrby key filed
		hsetnx：如果存则则不会进行添加
#### 6、List类型
	概念：与Java中Linkedlist类似，可以看作是一个双向链表结构。即可以支持正向索引和反向索引
	特征：有序、元素可重复、插入和删除、查询速度一般
	使用时机：对于存储顺序有要求的，例如，点赞列表、评论列表
	常见命令
		lpush key element：列表左侧插入一个或多个元素
		lpop key：移除并返回列表左侧的第一个元素，没有返回null
		rpush key element：列表右侧插入一个或多个元素
		rpop key：移除并返回右侧的第一个元素，没有返回null
		lrange key start end：返回一段角标范围内的所有元素（下标从0开始）
		 blpop、brpop，和上边的类似，但是当list中没有元素时，则会等待一段时间，可以指定时间
			 语法：blpop key time

### 7、Set类型
	概念：类似于Java中的HashSet，可以看做一个value为null的HashMap
	特征：无序、元素不可重复、查找快、支持交集、并集、差集
	常见命令
		    sadd key member：向set中添加一个元素
			srem key member：移除set中的指定元素
			scard key：返回set中的元素个数
			sismember key member：判断一个元素是否存在于set中
			smembers key：列出key中的所有变量
	多个set
			sinter key1 key2：求key1和key2的交集
			 sdiff key1 key2：求key1和key2的差集（key1有，key2没有）
			 sunion key1 key2：求key1和key2的并集

### 8、SortedSet类型
	概念：可排序的set集合，底层数据结构和set差别很大，此数据类型的每一个元素都带有一个score属性
		可以基于score属性进行排序，底层的实现是一个跳表（SkipList）加hash表
	特征：可排序、元素不重复、查询速度快
	用处：在排行榜之类的排序中可能会用到
	常见命令
		zadd key score member：添加一个或多个元素，如果已经存在则更新score值
		arem key member：删除其中的指定的元素
		zscore key member：获取指定元素的score值
		zrank key member：获得指定元素的排名
		zcard key：获取sortedSet中元素的个数
		zcount key min max：统计score在统计范围内所有元素的个数
		zincrby key increment member：让指定元素自增，increment为步长
		zrange key min max：按照score进行排名，返回排名后范围内的元素
		zrangebyscore key min max：按照score排序，返回依照指定score范围值内的所有元素
		zdiff、zinter、zunion：求差集、交集、并集
		注意：默认排名为升序，可以在z后面加rev变为反序


